# 연세바로치과 스케줄러 - 프로젝트 마스터 플랜

**프로젝트 총괄 가이드**
**작성일**: 2025-10-22
**버전**: 1.0

---

## 📊 프로젝트 개요

### 핵심 정보
- **프로젝트명**: 연세바로치과 스케줄 관리 시스템
- **기술 스택**: Next.js 14 (App Router) + TypeScript + Prisma + PostgreSQL
- **총 파일 개수**: 185개
- **예상 개발 기간**: 10주
- **예상 개발 시간**: 400시간

### 프로젝트 구조
```
총 185개 파일 구성:
├── 설정 파일: 6개 (3%)
├── 페이지: 24개 (13%)
├── 컴포넌트: 52개 (28%)
├── API 라우트: 42개 (23%)
├── 라이브러리/서비스: 28개 (15%)
├── 타입 정의: 7개 (4%)
└── 스타일/기타: 26개 (14%)
```

---

## 🎯 핵심 기능 요약

### 1. 원장 요일별 패턴 관리 ⭐
- 요일별 근무 패턴 저장
- 월간 일괄 적용
- 야간 진료 여부 설정

### 2. 연차/오프 신청 시스템 ⭐⭐⭐
- 직원용 외부 신청 링크
- 실시간 슬롯 현황 (3초 갱신)
- 주 2일 오프 제한
- 휴일 자동 제외
- PIN 번호 인증

### 3. 연차 관리 대시보드 ⭐⭐
- 달력뷰/목록뷰/직원별뷰
- 신청 확정/취소
- Excel/PDF 다운로드

### 4. 월간/주간 자동 배치 ⭐⭐⭐
- 완전 재배치 vs 스마트 배치
- 비율 기반 배치
- 형평성 고려
- 진행률 표시

### 5. 실시간 알림 시스템 ⭐
- Server-Sent Events (SSE)
- 브라우저 알림
- 알림 설정 관리

### 6. 형평성 관리 ⭐⭐
- 야간/주말 근무 형평성 계산
- 대시보드 시각화
- 히스토리 추적

### 7. 스케줄 배포 ⭐
- 확인 링크 생성
- 개인/전체/원장 스케줄 조회
- Excel/PDF 다운로드

---

## 📁 디렉토리 구조

```
연세바로치과 스케줄러/
├── .claude/                          # Claude Code 설정
│   ├── 00_프로젝트_마스터_플랜.md
│   ├── 01_개발_체크리스트.md
│   ├── 02_코딩_컨벤션.md
│   ├── 03_Phase1_가이드.md
│   ├── 04_Phase2_가이드.md
│   └── 05_Phase3_가이드.md
│
├── docs/                             # 기획 문서
│   ├── 연세바로치과_완전_개발_계획서_v3.0.md
│   ├── 연세바로치과_기능명세서_Part1_v2.1.md
│   ├── 연세바로치과_기능명세서_Part2_v2.1.md
│   ├── 연세바로치과_기능명세서_Part3_v2.1.md
│   └── 프로젝트_파일_개수_분석.md
│
├── prisma/                           # 데이터베이스
│   ├── schema.prisma
│   ├── seed.ts
│   └── migrations/
│
├── public/                           # 정적 리소스
│   ├── logo.png
│   ├── icon-192.png
│   ├── icon-512.png
│   └── manifest.json
│
├── src/
│   ├── app/                          # Next.js 14 App Router
│   │   ├── layout.tsx
│   │   ├── globals.css
│   │   │
│   │   ├── (auth)/                   # 인증 그룹
│   │   │   ├── login/
│   │   │   └── setup/
│   │   │
│   │   ├── (dashboard)/              # 대시보드 그룹
│   │   │   ├── layout.tsx
│   │   │   ├── calendar/
│   │   │   ├── leave-management/    ⭐ 신규
│   │   │   ├── statistics/
│   │   │   ├── notifications/       ⭐ 신규
│   │   │   ├── settings/
│   │   │   └── logs/
│   │   │
│   │   ├── (public)/                 # 공개 그룹
│   │   │   ├── layout.tsx
│   │   │   ├── leave-apply/[token]/ ⭐ 신규
│   │   │   └── schedule-view/[token]/ ⭐ 신규
│   │   │
│   │   └── api/                      # API 라우트
│   │       ├── auth/
│   │       ├── schedule/
│   │       ├── staff/
│   │       ├── doctors/
│   │       ├── doctor-pattern/      ⭐ 신규
│   │       ├── leave-apply/         ⭐ 신규
│   │       ├── leave-management/    ⭐ 신규
│   │       ├── auto-assign/
│   │       ├── notifications/       ⭐ 신규
│   │       ├── settings/
│   │       ├── statistics/
│   │       └── export/
│   │
│   ├── components/                   # React 컴포넌트
│   │   ├── ui/                       # shadcn/ui (15개)
│   │   ├── layout/                   # 레이아웃 (5개)
│   │   ├── calendar/                 # 달력 (6개)
│   │   ├── leave-management/        ⭐ 신규 (8개)
│   │   ├── public-apply/            ⭐ 신규 (6개)
│   │   ├── notifications/           ⭐ 신규 (4개)
│   │   ├── pattern/                 ⭐ 신규 (4개)
│   │   ├── schedule/                 # 스케줄 (6개)
│   │   ├── statistics/               # 통계 (5개)
│   │   └── settings/                 # 설정 (7개)
│   │
│   ├── lib/                          # 라이브러리
│   │   ├── prisma.ts
│   │   ├── auth.ts
│   │   ├── utils.ts
│   │   ├── date-utils.ts
│   │   │
│   │   ├── algorithms/               # 알고리즘
│   │   │   ├── auto-assign.ts
│   │   │   ├── monthly-assign.ts   ⭐ 신규
│   │   │   ├── weekly-assign.ts    ⭐ 신규
│   │   │   ├── fairness-calculator.ts
│   │   │   └── validation.ts
│   │   │
│   │   ├── services/                 # 서비스
│   │   │   ├── schedule-service.ts
│   │   │   ├── leave-service.ts    ⭐ 신규
│   │   │   ├── pattern-service.ts  ⭐ 신규
│   │   │   ├── notification-service.ts ⭐ 신규
│   │   │   └── export-service.ts
│   │   │
│   │   ├── hooks/                    # React Hooks
│   │   │   ├── use-schedule.ts
│   │   │   ├── use-leave-management.ts ⭐ 신규
│   │   │   ├── use-notifications.ts ⭐ 신규
│   │   │   ├── use-pattern.ts      ⭐ 신규
│   │   │   ├── use-auto-assign.ts
│   │   │   └── use-statistics.ts
│   │   │
│   │   └── stores/                   # 상태 관리 (Zustand)
│   │       ├── schedule-store.ts
│   │       ├── leave-store.ts      ⭐ 신규
│   │       ├── notification-store.ts ⭐ 신규
│   │       ├── ui-store.ts
│   │       └── auth-store.ts
│   │
│   ├── types/                        # TypeScript 타입
│   │   ├── index.ts
│   │   ├── schedule.ts
│   │   ├── staff.ts
│   │   ├── leave.ts                ⭐ 신규
│   │   ├── pattern.ts              ⭐ 신규
│   │   ├── notification.ts         ⭐ 신규
│   │   └── api.ts
│   │
│   └── styles/                       # 스타일
│       ├── globals.css
│       ├── calendar.css
│       └── print.css
│
├── __tests__/                        # 테스트
│   ├── setup.ts
│   ├── unit/
│   └── integration/
│
├── package.json
├── next.config.js
├── tsconfig.json
├── tailwind.config.ts
├── .env.local
├── .gitignore
└── README.md
```

---

## 🚀 개발 로드맵

### Phase 1: 기초 설정 (Week 1-2) - 25개 파일
**목표**: 프로젝트 기본 구조 완성

```
✅ 환경 설정
  □ Next.js 프로젝트 생성
  □ TypeScript 설정
  □ Tailwind CSS 설정
  □ Prisma 설정
  □ PostgreSQL 연결

✅ 데이터베이스
  □ Prisma 스키마 작성 (25개 테이블)
  □ 초기 마이그레이션
  □ Seed 데이터 작성

✅ 인증 시스템
  □ NextAuth 설정
  □ 로그인 페이지
  □ 세션 관리

✅ 기본 레이아웃
  □ 루트 레이아웃
  □ 대시보드 레이아웃
  □ 헤더/사이드바/푸터

✅ 달력 기본
  □ 달력 페이지
  □ 달력 그리드 컴포넌트
  □ 월 네비게이션
```

**상세 가이드**: `.claude/03_Phase1_가이드.md` 참조

---

### Phase 2: 핵심 기능 (Week 3-7) - 100개 파일
**목표**: 주요 비즈니스 로직 구현

#### Week 3: 원장 패턴 관리
```
✅ 원장 패턴 시스템
  □ 패턴 편집 UI
  □ 패턴 저장 API
  □ 월간 적용 로직
```

#### Week 4: 연차 신청 시스템
```
✅ 직원 신청 페이지
  □ 외부 링크 페이지
  □ 실시간 슬롯 현황 (SSE)
  □ 신청 폼
  □ PIN 번호 인증

✅ 신청 API
  □ 슬롯 제한 확인
  □ 주간 오프 제한 (주 2일)
  □ 휴일 체크
  □ 동시성 제어
```

#### Week 5: 연차 관리 대시보드
```
✅ 관리자 뷰
  □ 달력뷰 구현
  □ 목록뷰 구현
  □ 직원별뷰 구현
  □ 신청 확정/취소
  □ Excel/PDF 다운로드
```

#### Week 6: 자동 배치 시스템
```
✅ 배치 알고리즘
  □ 월간 배치 로직
  □ 주간 배치 로직
  □ 비율 기반 배치
  □ 형평성 계산

✅ 배치 UI
  □ 설정 모달
  □ 진행률 표시
  □ 결과 검증
```

#### Week 7: 알림 시스템
```
✅ 실시간 알림
  □ SSE 구현
  □ 알림 센터 UI
  □ 브라우저 알림
  □ 알림 설정
```

**상세 가이드**: `.claude/04_Phase2_가이드.md` 참조

---

### Phase 3: 완성 및 테스트 (Week 8-10) - 60개 파일
**목표**: 나머지 기능 구현 및 완성도 향상

#### Week 8: 통계 및 설정
```
✅ 통계 대시보드
  □ 월간/연간 통계
  □ 직원별 통계
  □ 차트 컴포넌트

✅ 설정 페이지
  □ 직원 관리
  □ 원장 관리
  □ 근무 규칙 설정
  □ 휴업일 설정
```

#### Week 9: 추가 기능
```
✅ 스케줄 배포
  □ 확인 링크 생성
  □ 조회 페이지
  □ Excel/PDF 생성

✅ 백업/복원
  □ 자동 백업
  □ 수동 백업
  □ 복원 기능
```

#### Week 10: 테스트 및 최적화
```
✅ 테스트
  □ 단위 테스트
  □ 통합 테스트
  □ E2E 테스트

✅ 최적화
  □ 성능 최적화
  □ SEO 최적화
  □ 접근성 개선

✅ 배포 준비
  □ Vercel 설정
  □ 환경 변수 설정
  □ 모니터링 설정
```

**상세 가이드**: `.claude/05_Phase3_가이드.md` 참조

---

## 📋 중요 체크포인트

### 코드 품질
- [ ] TypeScript 타입 안정성 100%
- [ ] ESLint 규칙 준수
- [ ] Prettier 포맷팅
- [ ] 코드 리뷰 완료

### 기능 완성도
- [ ] 모든 핵심 기능 동작
- [ ] 에러 핸들링 완료
- [ ] 로딩 상태 처리
- [ ] 빈 상태 처리

### 성능
- [ ] 페이지 로딩 < 2초
- [ ] API 응답 < 1초
- [ ] 자동 배치 < 30초
- [ ] 메모리 누수 없음

### 보안
- [ ] 인증/인가 완료
- [ ] CSRF 방어
- [ ] XSS 방어
- [ ] SQL Injection 방어
- [ ] Rate Limiting

### 사용성
- [ ] 반응형 디자인
- [ ] 접근성 (WCAG 2.1 AA)
- [ ] 에러 메시지 명확
- [ ] 도움말 제공

---

## 🎯 핵심 난이도별 파일

### 🔴 가장 어려운 파일 (20개)
**집중도**: ⭐⭐⭐⭐⭐

1. `prisma/schema.prisma` - 25개 테이블 설계
2. `src/app/api/leave-apply/[token]/submit/route.ts` - 동시성 제어
3. `src/lib/algorithms/monthly-assign.ts` - 월간 배치 알고리즘
4. `src/lib/algorithms/fairness-calculator.ts` - 형평성 계산
5. `src/app/api/notifications/sse/route.ts` - 실시간 알림
6. `src/components/public-apply/RealTimeStatus.tsx` - SSE 클라이언트
7. `src/lib/services/leave-service.ts` - 비즈니스 로직
8. `src/app/api/auto-assign/monthly/route.ts` - 월간 배치 API
9. `src/app/api/leave-management/period/[id]/confirm/route.ts` - 트랜잭션
10. `src/components/schedule/AutoAssignModal.tsx` - 복잡한 UI
11. `src/app/(public)/leave-apply/[token]/page.tsx` - 신청 페이지
12. `src/app/(dashboard)/leave-management/page.tsx` - 관리 대시보드
13. `src/lib/hooks/use-leave-management.ts` - 상태 관리
14. `src/lib/algorithms/validation.ts` - 검증 로직
15. `src/app/api/leave-apply/[token]/status/route.ts` - 슬롯 계산
16. `src/components/leave-management/Dashboard.tsx` - 대시보드 UI
17. `src/lib/services/notification-service.ts` - 알림 로직
18. `src/app/api/doctor-pattern/apply/route.ts` - 패턴 적용
19. `src/components/calendar/PatternApplyButton.tsx` - 패턴 적용 UI
20. `src/lib/algorithms/weekly-assign.ts` - 주간 배치

### 🟡 중간 난이도 (70개)
**집중도**: ⭐⭐⭐

- 나머지 API 라우트들
- 페이지 컴포넌트들
- 서비스 레이어
- 상태 관리
- 복잡한 UI 컴포넌트

### 🟢 쉬운 파일 (80개)
**집중도**: ⭐

- 설정 파일
- 타입 정의
- shadcn/ui 컴포넌트
- 간단한 페이지
- 간단한 API

---

## 💡 개발 원칙

### 1. 단계별 진행
- 한 번에 하나의 기능만 집중
- 완성 후 테스트
- 문제 발생 시 즉시 해결

### 2. 코드 재사용
- 공통 컴포넌트 최대 활용
- 유틸리티 함수 작성
- 패턴 일관성 유지

### 3. 문서화
- 주요 함수에 주석 작성
- README 업데이트
- API 문서 작성

### 4. 테스트
- 핵심 기능 테스트 필수
- 엣지 케이스 고려
- 실제 시나리오 테스트

### 5. 성능
- 불필요한 리렌더링 방지
- 데이터베이스 쿼리 최적화
- 이미지 최적화

---

## 📚 참고 문서

### 기획 문서
- `docs/연세바로치과_완전_개발_계획서_v3.0.md` - 전체 개요
- `docs/연세바로치과_기능명세서_Part1_v2.1.md` - 기능 상세 (섹션 1-3.3.2)
- `docs/연세바로치과_기능명세서_Part2_v2.1.md` - 기능 상세 (섹션 3.3.3-3.8)
- `docs/연세바로치과_기능명세서_Part3_v2.1.md` - 기술 상세 (섹션 4-11)
- `docs/프로젝트_파일_개수_분석.md` - 파일 구조 분석

### 개발 가이드
- `.claude/01_개발_체크리스트.md` - 파일별 체크리스트
- `.claude/02_코딩_컨벤션.md` - 코딩 규칙
- `.claude/03_Phase1_가이드.md` - Phase 1 상세
- `.claude/04_Phase2_가이드.md` - Phase 2 상세
- `.claude/05_Phase3_가이드.md` - Phase 3 상세

---

## 🎯 성공 기준

### 기능적 완성도
- ✅ 모든 핵심 기능 동작
- ✅ 에러 없이 안정적 운영
- ✅ 실제 사용 가능한 수준

### 코드 품질
- ✅ 타입 안정성 100%
- ✅ 일관된 코딩 스타일
- ✅ 유지보수 가능한 구조

### 사용자 경험
- ✅ 직관적인 UI/UX
- ✅ 빠른 응답 속도
- ✅ 모바일 지원

### 배포 준비
- ✅ 프로덕션 환경 설정
- ✅ 모니터링 설정
- ✅ 백업 시스템

---

**이 문서는 프로젝트 진행 시 항상 참고하는 마스터 가이드입니다.**

**다음 단계**: `.claude/01_개발_체크리스트.md` 확인
