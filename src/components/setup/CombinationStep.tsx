'use client'

import { useState, useRef, useEffect } from 'react'
import { Input } from '@/components/ui/input'
import { Label } from '@/components/ui/label'
import { Button } from '@/components/ui/button'
import { Checkbox } from '@/components/ui/checkbox'
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from '@/components/ui/select'
import { Plus, X, Calendar, Users, Upload, Download, AlertCircle, ChevronDown } from 'lucide-react'
import * as XLSX from 'xlsx'
import { Alert, AlertDescription } from '@/components/ui/alert'

interface Doctor {
  name: string
  shortName: string
  useCategory: boolean
  categories: Array<{
    name: string
    shortName: string
  }>
}

interface Combination {
  name: string
  dayOfWeek: string
  requiredStaff: number
  departmentRequiredStaff: { [departmentName: string]: number }
  // ë¶€ì„œë³„ êµ¬ë¶„ë³„ í•„ìš” ì¸ì›
  departmentCategoryStaff?: {
    [departmentName: string]: {
      [categoryName: string]: {
        count: number        // í•„ìš” ì¸ì›
        minRequired: number  // ê¼­ í•„ìš” ì¸ì› (0ì´ë©´ í•„ìˆ˜ ì•„ë‹˜)
      }
    }
  }
  doctors: string[]
  hasNightShift: boolean
}

interface CategoryRatios {
  [categoryName: string]: number // percentage (0-100)
}

interface Fairness {
  enableNightShiftFairness: boolean
  enableWeekendFairness: boolean
  enableHolidayFairness: boolean
  enableHolidayAdjacentFairness: boolean
}

interface Staff {
  name: string
  birthDate: string
  departmentName: string
  categoryName: string
  position: string
  workType: 'WEEK_4' | 'WEEK_5'
  flexibleForCategories: string[]
  flexibilityPriority: number
}

interface CombinationStepProps {
  data: Combination[]
  doctors: Doctor[]
  departments: { name: string; order: number; useAutoAssignment: boolean }[]
  staff: Staff[]  // ì¶”ê°€: í˜„ì¬ ì§ì› ìˆ˜ ê³„ì‚°ìš©
  fairness: Fairness
  categoryRatios: CategoryRatios
  categories: string[]
  onChange: (data: Combination[]) => void
  onFairnessChange: (fairness: Fairness) => void
  onCategoryRatiosChange: (ratios: CategoryRatios) => void
}

const DAYS_OF_WEEK = [
  { value: 'MONDAY', label: 'ì›”ìš”ì¼' },
  { value: 'TUESDAY', label: 'í™”ìš”ì¼' },
  { value: 'WEDNESDAY', label: 'ìˆ˜ìš”ì¼' },
  { value: 'THURSDAY', label: 'ëª©ìš”ì¼' },
  { value: 'FRIDAY', label: 'ê¸ˆìš”ì¼' },
  { value: 'SATURDAY', label: 'í† ìš”ì¼' },
  { value: 'SUNDAY', label: 'ì¼ìš”ì¼' },
]

export function CombinationStep({
  data,
  doctors,
  departments,
  staff,
  fairness,
  categoryRatios,
  categories,
  onChange,
  onFairnessChange,
  onCategoryRatiosChange,
}: CombinationStepProps) {
  const [newCombination, setNewCombination] = useState<Combination>({
    name: '',
    dayOfWeek: 'MONDAY',
    requiredStaff: 2,
    departmentRequiredStaff: {},
    doctors: [],
    hasNightShift: false,
  })
  const [selectedDoctorIndex, setSelectedDoctorIndex] = useState<number | null>(null)
  const [uploadError, setUploadError] = useState<string>('')
  const [expandedCombinations, setExpandedCombinations] = useState<Set<number>>(new Set())
  const fileInputRef = useRef<HTMLInputElement>(null)

  // ì˜ì‚¬ ëª©ë¡ ìƒì„± (ì´ë¦„ í‘œì‹œìš©, shortName ì¡°í•©ëª…ìš©)
  interface DoctorOption {
    displayName: string  // í™”ë©´ í‘œì‹œìš©: "ë°•ì›ì¥(ìƒë‹´)"
    shortName: string    // ì¡°í•©ëª…ìš©: "ë°•(ìƒë‹´)"
  }

  const getDoctorOptions = (): DoctorOption[] => {
    const options: DoctorOption[] = []
    doctors.forEach((doctor) => {
      if (doctor.useCategory && doctor.categories.length > 0) {
        doctor.categories.forEach((category) => {
          options.push({
            displayName: `${doctor.name}(${category.name})`,
            shortName: `${doctor.shortName}(${category.shortName || category.name})`
          })
        })
      } else {
        options.push({
          displayName: doctor.name,
          shortName: doctor.shortName
        })
      }
    })
    return options
  }

  const doctorOptions = getDoctorOptions()

  // ì„ íƒëœ ì˜ì‚¬ë“¤ë¡œë¶€í„° ì¡°í•©ëª… ìë™ ìƒì„± (shortName ì‚¬ìš©)
  const generateCombinationName = (selectedDoctors: string[]) => {
    return selectedDoctors.join('')
  }

  // ì˜ì‚¬ ì¶”ê°€ (ë²„íŠ¼ í´ë¦­ ë°©ì‹)
  const toggleDoctor = (index: number) => {
    const doctorOption = doctorOptions[index]
    const doctorShortName = doctorOption.shortName

    // ì´ë¯¸ ì„ íƒë˜ì–´ ìˆìœ¼ë©´ ì œê±°, ì—†ìœ¼ë©´ ì¶”ê°€
    const isSelected = newCombination.doctors.includes(doctorShortName)

    let updatedDoctors: string[]
    if (isSelected) {
      updatedDoctors = newCombination.doctors.filter(d => d !== doctorShortName)
    } else {
      updatedDoctors = [...newCombination.doctors, doctorShortName]
    }

    const autoGeneratedName = generateCombinationName(updatedDoctors)
    setNewCombination({
      ...newCombination,
      doctors: updatedDoctors,
      name: autoGeneratedName,
    })
  }

  // shortNameìœ¼ë¡œ displayName ì°¾ê¸°
  const getDisplayName = (shortName: string): string => {
    const option = doctorOptions.find(opt => opt.shortName === shortName)
    return option?.displayName || shortName
  }

  const addCombination = () => {
    if (newCombination.name.trim() && newCombination.doctors.length > 0) {
      onChange([...data, { ...newCombination }])
      setNewCombination({
        name: '',
        dayOfWeek: 'MONDAY',
        requiredStaff: 0,
        departmentRequiredStaff: {},
        doctors: [],
        hasNightShift: false,
      })
    }
  }

  const removeCombination = (index: number) => {
    onChange(data.filter((_, i) => i !== index))
  }

  const toggleExpand = (index: number) => {
    const newExpanded = new Set(expandedCombinations)
    if (newExpanded.has(index)) {
      newExpanded.delete(index)
    } else {
      newExpanded.add(index)
    }
    setExpandedCombinations(newExpanded)
  }

  const updateCombinationCategoryCount = (
    combIndex: number,
    deptName: string,
    catName: string,
    value: number
  ) => {
    const updated = [...data]
    const combination = updated[combIndex]

    if (!combination.departmentCategoryStaff) {
      combination.departmentCategoryStaff = {}
    }
    if (!combination.departmentCategoryStaff[deptName]) {
      combination.departmentCategoryStaff[deptName] = {}
    }

    const deptRequired = combination.departmentRequiredStaff[deptName] || 0
    const current = combination.departmentCategoryStaff[deptName][catName] || { count: 0, minRequired: 0 }

    combination.departmentCategoryStaff[deptName][catName] = {
      count: Math.min(deptRequired, Math.max(0, value)),
      minRequired: Math.min(current.minRequired, value)
    }

    onChange(updated)
  }

  const updateCombinationMinRequired = (
    combIndex: number,
    deptName: string,
    catName: string,
    value: number
  ) => {
    const updated = [...data]
    const combination = updated[combIndex]

    if (!combination.departmentCategoryStaff) {
      combination.departmentCategoryStaff = {}
    }
    if (!combination.departmentCategoryStaff[deptName]) {
      combination.departmentCategoryStaff[deptName] = {}
    }

    const current = combination.departmentCategoryStaff[deptName][catName] || { count: 0, minRequired: 0 }

    combination.departmentCategoryStaff[deptName][catName] = {
      ...current,
      minRequired: value
    }

    onChange(updated)
  }

  // ë¶€ì„œë³„ ì¸ì› ë° êµ¬ë¶„ë³„ ì¸ì› ìë™ ê³„ì‚° í—¬í¼ í•¨ìˆ˜
  const calculateDepartmentStaff = (requiredStaff: number) => {
    const autoAssignDepts = departments.filter(d => d.useAutoAssignment)

    if (autoAssignDepts.length === 0) {
      return {
        departmentRequiredStaff: {},
        departmentCategoryStaff: {}
      }
    }

    // ë¶€ì„œë³„ ê· ë“± ë°°ë¶„
    const perDept = Math.floor(requiredStaff / autoAssignDepts.length)
    const remainder = requiredStaff % autoAssignDepts.length

    const departmentRequiredStaff: { [departmentName: string]: number } = {}
    autoAssignDepts.forEach((dept, index) => {
      departmentRequiredStaff[dept.name] = perDept + (index < remainder ? 1 : 0)
    })

    // êµ¬ë¶„ë³„ ì¸ì› ìë™ ê³„ì‚°
    const departmentCategoryStaff: Combination['departmentCategoryStaff'] = {}

    autoAssignDepts.forEach(dept => {
      const deptRequired = departmentRequiredStaff[dept.name] || 0
      if (deptRequired === 0) return

      const deptStaff = staff.filter(s => s.departmentName === dept.name && s.categoryName)
      if (deptStaff.length === 0) {
        departmentCategoryStaff[dept.name] = {}
        return
      }

      const categoryCount: { [cat: string]: number } = {}
      deptStaff.forEach(s => {
        categoryCount[s.categoryName] = (categoryCount[s.categoryName] || 0) + 1
      })

      const totalStaff = deptStaff.length
      departmentCategoryStaff[dept.name] = {}

      Object.entries(categoryCount).forEach(([catName, count]) => {
        const ratio = count / totalStaff
        const allocatedCount = Math.round(deptRequired * ratio)

        if (allocatedCount > 0) {
          departmentCategoryStaff[dept.name]![catName] = {
            count: allocatedCount,
            minRequired: 0
          }
        }
      })
    })

    return { departmentRequiredStaff, departmentCategoryStaff }
  }

  // ë¶€ì„œë³„ í•„ìš” ì¸ì›ì´ ë³€ê²½ë˜ë©´ ìë™ìœ¼ë¡œ êµ¬ë¶„ë³„ ì¸ì› ê³„ì‚°
  useEffect(() => {
    const deptStaffKey = JSON.stringify(newCombination.departmentRequiredStaff)
    const hasDepartmentStaff = Object.values(newCombination.departmentRequiredStaff).some(count => count > 0)

    if (!hasDepartmentStaff) {
      // ë¶€ì„œë³„ ì¸ì›ì´ ì—†ìœ¼ë©´ êµ¬ë¶„ë³„ ì¸ì›ë„ ì´ˆê¸°í™”
      if (newCombination.departmentCategoryStaff && Object.keys(newCombination.departmentCategoryStaff).length > 0) {
        setNewCombination(prev => ({
          ...prev,
          departmentCategoryStaff: {}
        }))
      }
      return
    }

    const result: typeof newCombination.departmentCategoryStaff = {}

    departments
      .filter(dept => dept.useAutoAssignment)
      .forEach(dept => {
        const deptRequired = newCombination.departmentRequiredStaff[dept.name] || 0
        if (deptRequired === 0) return

        const deptStaff = staff.filter(s => s.departmentName === dept.name && s.categoryName)
        if (deptStaff.length === 0) {
          result[dept.name] = {}
          return
        }

        const categoryCount: { [cat: string]: number } = {}
        deptStaff.forEach(s => {
          categoryCount[s.categoryName] = (categoryCount[s.categoryName] || 0) + 1
        })

        const totalStaff = deptStaff.length
        result[dept.name] = {}

        Object.entries(categoryCount).forEach(([catName, count]) => {
          const ratio = count / totalStaff
          const allocatedCount = Math.round(deptRequired * ratio)

          // ê¸°ì¡´ ê°’ì´ ìˆê³  countê°€ ë™ì¼í•˜ë©´ minRequired ìœ ì§€
          const existingConfig = newCombination.departmentCategoryStaff?.[dept.name]?.[catName]
          result[dept.name]![catName] = {
            count: allocatedCount,
            minRequired: (existingConfig?.count === allocatedCount) ? (existingConfig.minRequired || 0) : 0
          }
        })
      })

    // ê²°ê³¼ê°€ ì‹¤ì œë¡œ ë³€ê²½ë˜ì—ˆëŠ”ì§€ í™•ì¸ (ë¬´í•œ ë£¨í”„ ë°©ì§€)
    const currentStr = JSON.stringify(newCombination.departmentCategoryStaff || {})
    const newStr = JSON.stringify(result)

    if (currentStr !== newStr) {
      setNewCombination(prev => ({
        ...prev,
        departmentCategoryStaff: result
      }))
    }
  }, [JSON.stringify(newCombination.departmentRequiredStaff), staff.length, departments.length])

  // ì—‘ì…€ í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ
  const downloadTemplate = () => {
    // ì €ì¥ëœ ì¡°í•©ì´ ìˆìœ¼ë©´ ì‹¤ì œ ë°ì´í„° ì‚¬ìš©, ì—†ìœ¼ë©´ ì˜ˆì œ ì‚¬ìš©
    const templateData = data.length > 0
      ? data.map((combination) => {
          const dayLabel = DAYS_OF_WEEK.find((d) => d.value === combination.dayOfWeek)?.label || combination.dayOfWeek
          const row: any = {
            ì¡°í•©ëª…: combination.name,
            ìš”ì¼: dayLabel,
            í•„ìš”ì¸ì›: combination.requiredStaff,
            êµ¬ë¶„: combination.hasNightShift ? 'ì•¼ê°„' : '',
          }

          // ì˜ì‚¬ ì •ë³´ ì¶”ê°€ (ìµœëŒ€ 10ëª…)
          combination.doctors.forEach((doctor, index) => {
            row[`ì˜ì‚¬${index + 1}`] = doctor
          })

          return row
        })
      : [
          {
            ì¡°í•©ëª…: 'ë°•(ìƒë‹´)êµ¬ìœ¤',
            ìš”ì¼: 'ì›”ìš”ì¼',
            í•„ìš”ì¸ì›: 2,
            êµ¬ë¶„: '',
            ì˜ì‚¬1: 'ë°•ì›ì¥(ìƒë‹´)',
            ì˜ì‚¬2: 'êµ¬ì›ì¥',
            ì˜ì‚¬3: 'ìœ¤ì›ì¥',
          },
          {
            ì¡°í•©ëª…: 'êµ¬ìœ¤',
            ìš”ì¼: 'ì›”ìš”ì¼',
            í•„ìš”ì¸ì›: 2,
            êµ¬ë¶„: 'ì•¼ê°„',
            ì˜ì‚¬1: 'êµ¬ì›ì¥',
            ì˜ì‚¬2: 'ìœ¤ì›ì¥',
            ì˜ì‚¬3: '',
          },
        ]

    const ws = XLSX.utils.json_to_sheet(templateData)
    const wb = XLSX.utils.book_new()
    XLSX.utils.book_append_sheet(wb, ws, 'ì˜ì‚¬ì¡°í•©')

    ws['!cols'] = [
      { wch: 15 },
      { wch: 10 },
      { wch: 10 },
      { wch: 10 },
      { wch: 15 },
      { wch: 15 },
      { wch: 15 },
    ]

    // ì˜ì‚¬ ëª©ë¡ ì‹œíŠ¸ ì¶”ê°€ (ì°¸ì¡°ìš©)
    const doctorListData = doctorOptions.length > 0
      ? doctorOptions.map(opt => ({ ì˜ì‚¬ëª…: opt.displayName, ì¡°í•©ëª…í‘œì‹œ: opt.shortName }))
      : [{ ì˜ì‚¬ëª…: 'ì›ì¥ ì •ë³´ë¥¼ ë¨¼ì € ì…ë ¥í•´ì£¼ì„¸ìš”', ì¡°í•©ëª…í‘œì‹œ: '-' }]
    const doctorListSheet = XLSX.utils.json_to_sheet(doctorListData)
    XLSX.utils.book_append_sheet(wb, doctorListSheet, 'ì˜ì‚¬ëª©ë¡')

    XLSX.writeFile(wb, 'ì˜ì‚¬ì¡°í•©_í…œí”Œë¦¿.xlsx')
  }


  // ì—‘ì…€ íŒŒì¼ ì—…ë¡œë“œ ì²˜ë¦¬
  const handleFileUpload = (e: React.ChangeEvent<HTMLInputElement>) => {
    const file = e.target.files?.[0]
    if (!file) return

    setUploadError('')

    const reader = new FileReader()
    reader.onload = (event) => {
      try {
        const workbook = XLSX.read(event.target?.result, { type: 'binary' })
        const sheetName = workbook.SheetNames[0]
        const worksheet = workbook.Sheets[sheetName]
        const jsonData = XLSX.utils.sheet_to_json(worksheet) as any[]

        if (jsonData.length === 0) {
          setUploadError('ì—‘ì…€ íŒŒì¼ì— ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.')
          return
        }

        const newCombinations: Combination[] = []
        const errors: string[] = []

        jsonData.forEach((row, index) => {
          const rowNum = index + 2

          // í•„ìˆ˜ í•„ë“œ ê²€ì¦
          if (!row['ì¡°í•©ëª…']) {
            errors.push(`${rowNum}í–‰: ì¡°í•©ëª…ì´ ëˆ„ë½ë˜ì—ˆìŠµë‹ˆë‹¤.`)
            return
          }

          if (!row['ìš”ì¼']) {
            errors.push(`${rowNum}í–‰: ìš”ì¼ì´ ëˆ„ë½ë˜ì—ˆìŠµë‹ˆë‹¤.`)
            return
          }

          // ìš”ì¼ ë³€í™˜
          const dayMapping: { [key: string]: string } = {
            ì›”ìš”ì¼: 'MONDAY',
            í™”ìš”ì¼: 'TUESDAY',
            ìˆ˜ìš”ì¼: 'WEDNESDAY',
            ëª©ìš”ì¼: 'THURSDAY',
            ê¸ˆìš”ì¼: 'FRIDAY',
            í† ìš”ì¼: 'SATURDAY',
            ì¼ìš”ì¼: 'SUNDAY',
            ì›”: 'MONDAY',
            í™”: 'TUESDAY',
            ìˆ˜: 'WEDNESDAY',
            ëª©: 'THURSDAY',
            ê¸ˆ: 'FRIDAY',
            í† : 'SATURDAY',
            ì¼: 'SUNDAY',
          }

          const dayStr = String(row['ìš”ì¼']).trim()
          const dayOfWeek = dayMapping[dayStr]
          if (!dayOfWeek) {
            errors.push(`${rowNum}í–‰: ì˜¬ë°”ë¥´ì§€ ì•Šì€ ìš”ì¼ì…ë‹ˆë‹¤. (${dayStr})`)
            return
          }

          // í•„ìš”ì¸ì› ê²€ì¦
          const requiredStaff = parseInt(String(row['í•„ìš”ì¸ì›'] || '2'))
          if (isNaN(requiredStaff) || requiredStaff < 1) {
            errors.push(`${rowNum}í–‰: í•„ìš”ì¸ì›ì€ 1 ì´ìƒì˜ ìˆ«ìì—¬ì•¼ í•©ë‹ˆë‹¤.`)
            return
          }

          // ì˜ì‚¬ ìˆ˜ì§‘
          const combinationDoctors: string[] = []
          for (let i = 1; i <= 10; i++) {
            const doctorKey = `ì˜ì‚¬${i}`
            if (row[doctorKey] && String(row[doctorKey]).trim()) {
              const doctorName = String(row[doctorKey]).trim()

              // ì˜ì‚¬ ì¡´ì¬ ì—¬ë¶€ í™•ì¸ (displayName ë˜ëŠ” shortName í—ˆìš©)
              const doctorOption = doctorOptions.find(
                opt => opt.displayName === doctorName || opt.shortName === doctorName
              )

              if (!doctorOption) {
                errors.push(
                  `${rowNum}í–‰: ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì˜ì‚¬ì…ë‹ˆë‹¤. (${doctorName})`
                )
                return
              }

              // shortNameì„ ì €ì¥ (ì¡°í•©ëª…ìš©)
              combinationDoctors.push(doctorOption.shortName)
            }
          }

          if (combinationDoctors.length === 0) {
            errors.push(`${rowNum}í–‰: ìµœì†Œ 1ëª…ì˜ ì˜ì‚¬ê°€ í•„ìš”í•©ë‹ˆë‹¤.`)
            return
          }

          // ì•¼ê°„ ì§„ë£Œ ì—¬ë¶€ (êµ¬ë¶„ ì»¬ëŸ¼ì—ì„œ í™•ì¸)
          const hasNightShift = String(row['êµ¬ë¶„'] || '').trim() === 'ì•¼ê°„'

          // ë¶€ì„œë³„ ì¸ì› ë° êµ¬ë¶„ë³„ ì¸ì› ìë™ ê³„ì‚°
          const { departmentRequiredStaff, departmentCategoryStaff } = calculateDepartmentStaff(requiredStaff)

          newCombinations.push({
            name: String(row['ì¡°í•©ëª…']).trim(),
            dayOfWeek,
            requiredStaff,
            departmentRequiredStaff,
            departmentCategoryStaff,
            doctors: combinationDoctors,
            hasNightShift,
          })
        })

        if (errors.length > 0) {
          setUploadError(errors.join('\n'))
          return
        }

        // ê¸°ì¡´ ë°ì´í„°ì— ì¶”ê°€
        onChange([...data, ...newCombinations])

        alert(`${newCombinations.length}ê°œì˜ ì¡°í•©ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.`)

        if (fileInputRef.current) {
          fileInputRef.current.value = ''
        }
      } catch (error) {
        console.error('Excel upload error:', error)
        setUploadError('ì—‘ì…€ íŒŒì¼ì„ ì½ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.')
      }
    }

    reader.readAsBinaryString(file)
  }

  return (
    <div className="space-y-6">
      <div className="text-center mb-8">
        <h2 className="text-2xl font-bold text-gray-900 mb-2">ì˜ì‚¬ ì¡°í•© ì„¤ì •</h2>
        <p className="text-gray-600">
          ì¼ íŒ¨í„´ì— ì‚¬ìš©ë  ì˜ì‚¬ ì¡°í•©ì„ ìš”ì¼ë³„ë¡œ ì„¤ì •í•´ì£¼ì„¸ìš”
        </p>
      </div>

      {/* ì—‘ì…€ ì—…ë¡œë“œ ì„¹ì…˜ */}
      <div className="p-4 bg-gradient-to-r from-green-50 to-blue-50 rounded-lg border border-green-200">
        <div className="flex items-center justify-between">
          <div className="flex items-center gap-2">
            <Upload className="w-5 h-5 text-green-600" />
            <div>
              <h3 className="font-semibold text-gray-900">ì—‘ì…€ë¡œ ì¼ê´„ ë“±ë¡</h3>
              <p className="text-sm text-gray-600">
                ì—¬ëŸ¬ ê°œì˜ ì¡°í•©ì„ í•œ ë²ˆì— ë“±ë¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
              </p>
            </div>
          </div>
          <div className="flex gap-2">
            <Button
              variant="outline"
              size="sm"
              onClick={downloadTemplate}
              className="h-9 border-green-300 hover:bg-green-50"
            >
              <Download className="w-4 h-4 mr-1" />
              í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ
            </Button>
            <input
              ref={fileInputRef}
              type="file"
              accept=".xlsx,.xls"
              onChange={handleFileUpload}
              className="hidden"
            />
            <Button
              size="sm"
              onClick={() => fileInputRef.current?.click()}
              className="h-9 bg-green-600 hover:bg-green-700"
            >
              <Upload className="w-4 h-4 mr-1" />
              ì—‘ì…€ ì—…ë¡œë“œ
            </Button>
          </div>
        </div>
      </div>

      {/* ì—…ë¡œë“œ ì—ëŸ¬ ë©”ì‹œì§€ */}
      {uploadError && (
        <Alert variant="destructive">
          <AlertCircle className="h-4 w-4" />
          <AlertDescription className="whitespace-pre-line">
            {uploadError}
          </AlertDescription>
        </Alert>
      )}

      {/* ì¡°í•© ëª©ë¡ */}
      {data.length > 0 && (
        <div className="space-y-3">
          {data.map((combination, index) => {
            const isExpanded = expandedCombinations.has(index)
            // ìë™ë°°ì¹˜ ë¶€ì„œê°€ ìˆìœ¼ë©´ í¼ì¹¨ ë²„íŠ¼ í‘œì‹œ
            const hasAutoAssignDepts = departments.some(d => d.useAutoAssignment)
            const hasDeptStaff = hasAutoAssignDepts && (
              Object.keys(combination.departmentRequiredStaff || {}).some(
                dept => (combination.departmentRequiredStaff[dept] || 0) > 0
              ) || combination.requiredStaff > 0
            )

            return (
              <div
                key={index}
                className="bg-white rounded-lg border border-gray-200 overflow-hidden"
              >
                <div className="p-4 bg-gray-50">
                  <div className="flex items-start justify-between">
                    <div className="flex items-center gap-3 flex-1">
                      <Calendar className="w-5 h-5 text-blue-600" />
                      <div className="flex-1">
                        <h3 className="font-semibold text-lg">{combination.name}</h3>
                        <div className="flex items-center gap-3 mt-1 text-sm text-gray-600">
                          <span className="inline-flex items-center gap-1">
                            ğŸ“…{' '}
                            {DAYS_OF_WEEK.find((d) => d.value === combination.dayOfWeek)
                              ?.label || combination.dayOfWeek}
                          </span>
                          <span className="inline-flex items-center gap-1">
                            ğŸ‘¥ í•„ìš”ì¸ì›: {
                              Object.keys(combination.departmentRequiredStaff || {}).length > 0
                                ? Object.entries(combination.departmentRequiredStaff)
                                    .filter(([_, count]) => count > 0)
                                    .map(([dept, count]) => `${dept} ${count}ëª…`)
                                    .join(', ')
                                : `${combination.requiredStaff}ëª… (ì „ì²´)`
                            }
                          </span>
                          {combination.hasNightShift && (
                            <span className="inline-flex items-center gap-1 px-2 py-0.5 bg-indigo-100 text-indigo-700 rounded text-xs font-medium">
                              ğŸŒ™ ì•¼ê°„ì§„ë£Œ
                            </span>
                          )}
                        </div>
                      </div>
                    </div>
                    <div className="flex items-center gap-2">
                      {hasDeptStaff && (
                        <Button
                          variant="ghost"
                          size="sm"
                          onClick={() => toggleExpand(index)}
                          className="h-8 w-8 p-0"
                        >
                          <ChevronDown className={`w-4 h-4 transition-transform ${isExpanded ? 'rotate-180' : ''}`} />
                        </Button>
                      )}
                      <Button
                        variant="ghost"
                        size="sm"
                        onClick={() => removeCombination(index)}
                        className="h-8 w-8 p-0 hover:bg-red-100 hover:text-red-600"
                      >
                        <X className="w-4 h-4" />
                      </Button>
                    </div>
                  </div>

                  <div className="ml-8 mt-3">
                    <Label className="text-xs text-gray-500 mb-2 block">
                      ì˜ì‚¬ êµ¬ì„±:
                    </Label>
                    <div className="flex flex-wrap gap-2">
                      {combination.doctors.map((doctorShortName, docIndex) => (
                        <span
                          key={docIndex}
                          className="inline-flex items-center px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm font-medium"
                        >
                          {getDisplayName(doctorShortName)}
                        </span>
                      ))}
                    </div>
                  </div>
                </div>

                {/* í¼ì³ì§„ ê²½ìš° êµ¬ë¶„ë³„ ìƒì„¸ ì¸ì› í‘œì‹œ */}
                {isExpanded && hasDeptStaff && (
                  <div className="p-4 border-t border-gray-200 bg-white space-y-4">
                    <div className="flex items-center justify-between mb-2">
                      <Label className="text-sm font-semibold text-blue-700">êµ¬ë¶„ë³„ ìƒì„¸ ì¸ì›</Label>
                      {(!combination.departmentRequiredStaff || Object.keys(combination.departmentRequiredStaff).length === 0) && (
                        <Button
                          variant="outline"
                          size="sm"
                          onClick={() => {
                            const { departmentRequiredStaff, departmentCategoryStaff } = calculateDepartmentStaff(combination.requiredStaff)
                            const updated = [...data]
                            updated[index] = {
                              ...combination,
                              departmentRequiredStaff,
                              departmentCategoryStaff
                            }
                            onChange(updated)
                          }}
                          className="h-7 text-xs"
                        >
                          ìë™ ê³„ì‚°
                        </Button>
                      )}
                    </div>

                    {(!combination.departmentRequiredStaff || Object.keys(combination.departmentRequiredStaff).length === 0) ? (
                      <div className="p-4 bg-blue-50 border border-blue-200 rounded text-center">
                        <p className="text-sm text-blue-900">
                          ìœ„ì˜ "ìë™ ê³„ì‚°" ë²„íŠ¼ì„ ëˆŒëŸ¬ ë¶€ì„œë³„/êµ¬ë¶„ë³„ ì¸ì›ì„ ì„¤ì •í•´ì£¼ì„¸ìš”.
                        </p>
                      </div>
                    ) : (
                      departments
                        .filter(dept => dept.useAutoAssignment && (combination.departmentRequiredStaff[dept.name] || 0) > 0)
                        .map(dept => {
                        const deptRequired = combination.departmentRequiredStaff[dept.name] || 0
                        const deptStaff = staff.filter(s => s.departmentName === dept.name && s.categoryName)
                        const deptCategories = Array.from(new Set(deptStaff.map(s => s.categoryName)))

                        if (deptCategories.length === 0) {
                          return (
                            <div key={dept.name} className="p-3 bg-amber-50 border border-amber-200 rounded">
                              <p className="text-xs text-amber-900">
                                âš ï¸ {dept.name} ë¶€ì„œì— êµ¬ë¶„ì´ ì„¤ì •ëœ ì§ì›ì´ ì—†ìŠµë‹ˆë‹¤.
                              </p>
                            </div>
                          )
                        }

                        const currentStaff = combination.departmentCategoryStaff?.[dept.name] || {}

                        return (
                          <div key={dept.name} className="p-4 bg-gray-50 border border-gray-200 rounded-lg">
                            <h4 className="font-semibold text-sm mb-3">{dept.name} (ì´ {deptRequired}ëª…)</h4>
                            <div className="space-y-2">
                              {deptCategories.map(cat => {
                                const config = currentStaff[cat] || { count: 0, minRequired: 0 }

                                return (
                                  <div key={cat} className="grid grid-cols-[120px_1fr_1fr] gap-4 items-center p-2 bg-white rounded">
                                    <Label className="text-xs font-medium">{cat}</Label>

                                    <div className="flex items-center gap-2">
                                      <Label className="text-xs text-gray-500 w-12">ì¸ì›:</Label>
                                      <Input
                                        type="number"
                                        min={0}
                                        max={deptRequired}
                                        value={config.count}
                                        onChange={(e) =>
                                          updateCombinationCategoryCount(
                                            index,
                                            dept.name,
                                            cat,
                                            parseInt(e.target.value) || 0
                                          )
                                        }
                                        className="h-8 flex-1"
                                      />
                                      <span className="text-xs text-gray-600">ëª…</span>
                                    </div>

                                    <div className="flex items-center gap-2">
                                      <Checkbox
                                        id={`min-${index}-${dept.name}-${cat}`}
                                        checked={config.minRequired > 0}
                                        onCheckedChange={(checked) =>
                                          updateCombinationMinRequired(
                                            index,
                                            dept.name,
                                            cat,
                                            checked ? config.count : 0
                                          )
                                        }
                                      />
                                      <Label
                                        htmlFor={`min-${index}-${dept.name}-${cat}`}
                                        className="text-xs cursor-pointer flex-1"
                                      >
                                        í•„ìˆ˜
                                      </Label>
                                      {config.minRequired > 0 && (
                                        <>
                                          <Input
                                            type="number"
                                            min={0}
                                            max={config.count}
                                            value={config.minRequired}
                                            onChange={(e) =>
                                              updateCombinationMinRequired(
                                                index,
                                                dept.name,
                                                cat,
                                                Math.min(config.count, Math.max(0, parseInt(e.target.value) || 0))
                                              )
                                            }
                                            className="h-8 w-20"
                                          />
                                          <div className="flex items-center gap-1 px-2 py-1 bg-green-50 border border-green-200 rounded">
                                            <span className="text-xs text-green-700 font-medium">
                                              ìœ ì—°: {config.count - config.minRequired}ëª…
                                            </span>
                                          </div>
                                        </>
                                      )}
                                    </div>
                                  </div>
                                )
                              })}
                            </div>
                          </div>
                        )
                      })
                    )}
                  </div>
                )}
              </div>
            )
          })}
        </div>
      )}

      {/* ìƒˆ ì¡°í•© ì¶”ê°€ */}
      <div className="p-5 bg-gray-50 rounded-lg border border-gray-200">
        <div className="flex items-center gap-2 mb-4">
          <Users className="w-5 h-5 text-blue-600" />
          <h3 className="font-semibold">ìƒˆ ì¡°í•© ì¶”ê°€</h3>
        </div>

        <div className="space-y-4">
          {/* ì¡°í•©ëª…, ìš”ì¼ */}
          <div className="grid md:grid-cols-2 gap-3">
            <div className="space-y-1">
              <Label className="text-xs">ì¡°í•©ëª… * (ìë™ ìƒì„±, ìˆ˜ì • ê°€ëŠ¥)</Label>
              <Input
                value={newCombination.name}
                onChange={(e) =>
                  setNewCombination({ ...newCombination, name: e.target.value })
                }
                placeholder="ì˜ì‚¬ë¥¼ ì„ íƒí•˜ë©´ ìë™ ìƒì„±ë©ë‹ˆë‹¤"
                className="h-9"
              />
            </div>

            <div className="space-y-1">
              <Label className="text-xs">ìš”ì¼ *</Label>
              <Select
                value={newCombination.dayOfWeek}
                onValueChange={(value) =>
                  setNewCombination({ ...newCombination, dayOfWeek: value })
                }
              >
                <SelectTrigger className="h-9">
                  <SelectValue />
                </SelectTrigger>
                <SelectContent>
                  {DAYS_OF_WEEK.map((day) => (
                    <SelectItem key={day.value} value={day.value}>
                      {day.label}
                    </SelectItem>
                  ))}
                </SelectContent>
              </Select>
            </div>
          </div>

          {/* ë¶€ì„œë³„ í•„ìš” ì¸ì› */}
          <div className="space-y-2">
            <Label className="text-xs font-semibold">ë¶€ì„œë³„ í•„ìš” ì¸ì› *</Label>
            <div className="space-y-2 p-3 bg-blue-50 rounded border border-blue-200">
              {departments
                .filter(dept => dept.useAutoAssignment)
                .map((dept) => (
                  <div key={dept.name} className="flex items-center gap-2">
                    <Label className="text-xs w-20">{dept.name}</Label>
                    <Input
                      type="number"
                      min={0}
                      value={newCombination.departmentRequiredStaff[dept.name] || 0}
                      onChange={(e) =>
                        setNewCombination({
                          ...newCombination,
                          departmentRequiredStaff: {
                            ...newCombination.departmentRequiredStaff,
                            [dept.name]: parseInt(e.target.value) || 0,
                          },
                          // ì „ì²´ í•©ê³„ë„ ì—…ë°ì´íŠ¸ (ë ˆê±°ì‹œ í˜¸í™˜ìš©)
                          requiredStaff: Object.values({
                            ...newCombination.departmentRequiredStaff,
                            [dept.name]: parseInt(e.target.value) || 0,
                          }).reduce((sum, val) => sum + val, 0),
                        })
                      }
                      className="h-8 flex-1"
                    />
                    <span className="text-xs text-gray-600">ëª…</span>
                  </div>
                ))}
            </div>
            {departments.filter(d => d.useAutoAssignment).length === 0 && (
              <p className="text-xs text-amber-700 bg-amber-50 p-2 rounded border border-amber-200">
                âš ï¸ ìë™ë°°ì¹˜ë¥¼ ì‚¬ìš©í•˜ëŠ” ë¶€ì„œê°€ ì—†ìŠµë‹ˆë‹¤. 2ë‹¨ê³„ì—ì„œ ì„¤ì •í•´ì£¼ì„¸ìš”.
              </p>
            )}
          </div>

          {/* êµ¬ë¶„ë³„ ìƒì„¸ ì¸ì› ì„¤ì • */}
          {Object.entries(newCombination.departmentRequiredStaff).some(([dept, count]) =>
            departments.find(d => d.name === dept && d.useAutoAssignment) && count > 0
          ) && (
            <div className="space-y-3">
              <Label className="text-sm font-semibold text-blue-700">êµ¬ë¶„ë³„ ìƒì„¸ ì¸ì› (ìë™ ê³„ì‚°ë¨)</Label>

              {departments
                .filter(dept => dept.useAutoAssignment && (newCombination.departmentRequiredStaff[dept.name] || 0) > 0)
                .map(dept => {
                  const deptRequired = newCombination.departmentRequiredStaff[dept.name] || 0
                  const deptStaff = staff.filter(s => s.departmentName === dept.name && s.categoryName)
                  const deptCategories = Array.from(new Set(deptStaff.map(s => s.categoryName)))

                  if (deptCategories.length === 0) {
                    return (
                      <div key={dept.name} className="p-3 bg-amber-50 border border-amber-200 rounded">
                        <p className="text-xs text-amber-900">
                          âš ï¸ {dept.name} ë¶€ì„œì— êµ¬ë¶„ì´ ì„¤ì •ëœ ì§ì›ì´ ì—†ìŠµë‹ˆë‹¤.
                        </p>
                      </div>
                    )
                  }

                  const currentStaff = newCombination.departmentCategoryStaff?.[dept.name] || {}

                  return (
                    <div key={dept.name} className="p-4 bg-white border border-gray-200 rounded-lg">
                      <h4 className="font-semibold text-sm mb-3">{dept.name} (ì´ {deptRequired}ëª…)</h4>
                      <div className="space-y-2">
                        {deptCategories.map(cat => {
                          const config = currentStaff[cat] || { count: 0, minRequired: 0 }

                          return (
                            <div key={cat} className="p-2 bg-gray-50 rounded">
                              <div className="flex items-center gap-2 flex-wrap">
                                {/* êµ¬ë¶„ëª… */}
                                <div className="w-24 flex-shrink-0">
                                  <Label className="text-xs font-medium">{cat}</Label>
                                </div>

                                {/* ì¸ì› */}
                                <div className="flex items-center gap-1">
                                  <Label className="text-xs text-gray-500">ì¸ì›:</Label>
                                  <Input
                                    type="number"
                                    min={0}
                                    max={deptRequired}
                                    value={config.count}
                                    onChange={(e) => {
                                      const value = Math.min(deptRequired, Math.max(0, parseInt(e.target.value) || 0))
                                      setNewCombination({
                                        ...newCombination,
                                        departmentCategoryStaff: {
                                          ...newCombination.departmentCategoryStaff,
                                          [dept.name]: {
                                            ...currentStaff,
                                            [cat]: {
                                              count: value,
                                              minRequired: Math.min(config.minRequired, value)
                                            }
                                          }
                                        }
                                      })
                                    }}
                                    className="h-8 w-16"
                                  />
                                  <span className="text-xs text-gray-600">ëª…</span>
                                </div>

                                {/* í•„ìˆ˜ ì²´í¬ë°•ìŠ¤ */}
                                <div className="flex items-center gap-1">
                                  <Checkbox
                                    id={`min-${dept.name}-${cat}`}
                                    checked={config.minRequired > 0}
                                    onCheckedChange={(checked) => {
                                      setNewCombination({
                                        ...newCombination,
                                        departmentCategoryStaff: {
                                          ...newCombination.departmentCategoryStaff,
                                          [dept.name]: {
                                            ...currentStaff,
                                            [cat]: {
                                              ...config,
                                              minRequired: checked ? config.count : 0
                                            }
                                          }
                                        }
                                      })
                                    }}
                                  />
                                  <Label htmlFor={`min-${dept.name}-${cat}`} className="text-xs cursor-pointer">
                                    í•„ìˆ˜
                                  </Label>
                                </div>

                                {/* í•„ìˆ˜ ì¸ì› ì…ë ¥ */}
                                {config.minRequired > 0 && (
                                  <>
                                    <Input
                                      type="number"
                                      min={0}
                                      max={config.count}
                                      value={config.minRequired}
                                      onChange={(e) => {
                                        const value = Math.min(config.count, Math.max(0, parseInt(e.target.value) || 0))
                                        setNewCombination({
                                          ...newCombination,
                                          departmentCategoryStaff: {
                                            ...newCombination.departmentCategoryStaff,
                                            [dept.name]: {
                                              ...currentStaff,
                                              [cat]: {
                                                ...config,
                                                minRequired: value
                                              }
                                            }
                                          }
                                        })
                                      }}
                                      className="h-8 w-16"
                                    />
                                    <span className="text-xs text-gray-600">ëª…</span>

                                    {/* ìœ ì—° ì¸ì› í‘œì‹œ */}
                                    <div className="flex items-center gap-1 px-2 py-1 bg-green-50 border border-green-200 rounded">
                                      <span className="text-xs text-green-700 font-medium">
                                        ìœ ì—°: {config.count - config.minRequired}ëª…
                                      </span>
                                    </div>
                                  </>
                                )}
                              </div>
                            </div>
                          )
                        })}
                      </div>
                    </div>
                  )
                })}

              <p className="text-xs text-gray-600 bg-blue-50 p-2 rounded">
                ğŸ’¡ <strong>í•„ìˆ˜ ì¸ì›:</strong> ì²´í¬í•˜ë©´ ìë™ë°°ì¹˜ ì‹œ ë°˜ë“œì‹œ ë°°ì¹˜ë˜ì–´ì•¼ í•˜ëŠ” ìµœì†Œ ì¸ì›ì…ë‹ˆë‹¤.
              </p>
            </div>
          )}

          {/* ì•¼ê°„ ì§„ë£Œ ì—¬ë¶€ */}
          <div className="flex items-center space-x-2">
            <Checkbox
              id="hasNightShift"
              checked={newCombination.hasNightShift}
              onCheckedChange={(checked) =>
                setNewCombination({
                  ...newCombination,
                  hasNightShift: checked === true,
                })
              }
            />
            <Label
              htmlFor="hasNightShift"
              className="text-sm font-medium cursor-pointer"
            >
              ğŸŒ™ ì•¼ê°„ ì§„ë£Œ í¬í•¨
            </Label>
          </div>

          {/* ì˜ì‚¬ ì„ íƒ - ë²„íŠ¼ ë°©ì‹ */}
          <div className="space-y-2">
            <Label className="text-xs">ì˜ì‚¬ ì„ íƒ * (í´ë¦­í•˜ì—¬ ì„ íƒ/í•´ì œ)</Label>
            <div className="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2 p-3 bg-gray-50 rounded border border-gray-200">
              {doctorOptions.map((option, index) => {
                const isSelected = newCombination.doctors.includes(option.shortName)
                return (
                  <Button
                    key={index}
                    type="button"
                    variant={isSelected ? "default" : "outline"}
                    size="sm"
                    onClick={() => toggleDoctor(index)}
                    className={`h-auto py-2 px-3 justify-start text-left ${
                      isSelected
                        ? 'bg-blue-600 hover:bg-blue-700 text-white'
                        : 'hover:bg-gray-100'
                    }`}
                  >
                    <span className="truncate">{option.displayName}</span>
                  </Button>
                )
              })}
            </div>

            {/* ì„ íƒëœ ì˜ì‚¬ ëª©ë¡ í‘œì‹œ */}
            {newCombination.doctors.length > 0 && (
              <div className="text-xs text-gray-600 p-2 bg-blue-50 rounded border border-blue-200">
                ì„ íƒë¨: {newCombination.doctors.map(d => getDisplayName(d)).join(', ')}
              </div>
            )}
          </div>

          <Button
            onClick={addCombination}
            disabled={
              !newCombination.name.trim() || newCombination.doctors.length === 0
            }
            className="w-full h-10 bg-blue-600"
          >
            <Plus className="w-4 h-4 mr-2" />
            ì¡°í•© ì¶”ê°€
          </Button>
        </div>
      </div>

      {/* í˜•í‰ì„± ì„¤ì • */}
      <div className="p-5 bg-gray-50 rounded-lg border border-gray-200">
        <h3 className="font-semibold mb-4 text-gray-900">í˜•í‰ì„± ê¸°ë°˜ ê·¼ë¬´ ë°°ì¹˜</h3>
        <p className="text-sm text-gray-600 mb-4">
          ì‚¬ìš©í•  í˜•í‰ì„± í•­ëª©ì„ ì„ íƒí•˜ì„¸ìš”. ê° í•­ëª©ì€ ë…ë¦½ì ìœ¼ë¡œ ê´€ë¦¬ë©ë‹ˆë‹¤.
        </p>
        <div className="space-y-3">
          <div className="flex items-start space-x-3 p-3 bg-white rounded-lg border border-gray-200">
            <Checkbox
              id="fairness-night"
              checked={fairness.enableNightShiftFairness}
              onCheckedChange={(checked) =>
                onFairnessChange({ ...fairness, enableNightShiftFairness: checked as boolean })
              }
            />
            <div className="flex-1">
              <Label htmlFor="fairness-night" className="cursor-pointer font-medium text-gray-900">
                ì•¼ê°„ ê·¼ë¬´ í˜•í‰ì„±
              </Label>
              <p className="text-xs text-gray-500 mt-1">
                í‰ì¼ ì•¼ê°„ ì§„ë£Œ ê·¼ë¬´ íšŸìˆ˜ë¥¼ ì¶”ì í•©ë‹ˆë‹¤
              </p>
            </div>
          </div>

          <div className="flex items-start space-x-3 p-3 bg-white rounded-lg border border-gray-200">
            <Checkbox
              id="fairness-weekend"
              checked={fairness.enableWeekendFairness}
              onCheckedChange={(checked) =>
                onFairnessChange({ ...fairness, enableWeekendFairness: checked as boolean })
              }
            />
            <div className="flex-1">
              <Label htmlFor="fairness-weekend" className="cursor-pointer font-medium text-gray-900">
                ì£¼ë§ ê·¼ë¬´ í˜•í‰ì„±
              </Label>
              <p className="text-xs text-gray-500 mt-1">
                í† ìš”ì¼ ê·¼ë¬´ íšŸìˆ˜ë¥¼ ì¶”ì í•©ë‹ˆë‹¤
              </p>
            </div>
          </div>

          <div className="flex items-start space-x-3 p-3 bg-white rounded-lg border border-gray-200">
            <Checkbox
              id="fairness-holiday"
              checked={fairness.enableHolidayFairness}
              onCheckedChange={(checked) =>
                onFairnessChange({ ...fairness, enableHolidayFairness: checked as boolean })
              }
            />
            <div className="flex-1">
              <Label htmlFor="fairness-holiday" className="cursor-pointer font-medium text-gray-900">
                ê³µíœ´ì¼ ê·¼ë¬´ í˜•í‰ì„±
              </Label>
              <p className="text-xs text-gray-500 mt-1">
                ê³µíœ´ì¼ ê·¼ë¬´ íšŸìˆ˜ë¥¼ ì¶”ì í•©ë‹ˆë‹¤ (ì¼ìš”ì¼ ì œì™¸, ë‹¨ ê³µíœ´ì¼ê³¼ ë¶™ì–´ìˆëŠ” ì¼ìš”ì¼ì€ í¬í•¨)
              </p>
            </div>
          </div>

          <div className="flex items-start space-x-3 p-3 bg-white rounded-lg border border-gray-200">
            <Checkbox
              id="fairness-holiday-adjacent"
              checked={fairness.enableHolidayAdjacentFairness}
              onCheckedChange={(checked) =>
                onFairnessChange({ ...fairness, enableHolidayAdjacentFairness: checked as boolean })
              }
            />
            <div className="flex-1">
              <Label htmlFor="fairness-holiday-adjacent" className="cursor-pointer font-medium text-gray-900">
                ê³µíœ´ì¼ ì „í›„ ê·¼ë¬´ í˜•í‰ì„±
              </Label>
              <p className="text-xs text-gray-500 mt-1">
                ê³µíœ´ì¼ ì „ë‚ /ë‹¤ìŒë‚  ê·¼ë¬´ íšŸìˆ˜ë¥¼ ì¶”ì í•©ë‹ˆë‹¤ (ì˜ˆ: 5ì›” 3ì¼(í† ), 5ì›” 6ì¼(í™”) ë“±)
              </p>
            </div>
          </div>
        </div>
      </div>

      <div className="p-4 bg-blue-50 rounded-lg border border-blue-100">
        <p className="text-sm text-blue-900">
          ğŸ’¡ <strong>ì•ˆë‚´:</strong> ì˜ì‚¬ ì¡°í•©ì€ í•˜ë£¨ì˜ ì§„ë£Œ íŒ¨í„´ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.
          ì˜ˆë¥¼ ë“¤ì–´ "ì›”ìš”ì¼ ì¡°í•©"ìœ¼ë¡œ ë°•(ìƒë‹´)êµ¬ìœ¤ / êµ¬ìœ¤ / ë°•(ì§„ë£Œ)êµ¬ìœ¤ 3ê°€ì§€
          ì¡°í•©ì„ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        </p>
      </div>
    </div>
  )
}
